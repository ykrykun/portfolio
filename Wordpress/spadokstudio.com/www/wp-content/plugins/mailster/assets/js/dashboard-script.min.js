mailster=function(o,d,a,c){"use strict";var e=d(c.body).hasClass("mobile"),t=d(c.body).hasClass("index-php"),n=d(".mailster-mb-subscribers"),s=d("#mailster-subscriber-range"),i=d("#subscriber-chart-wrap"),r=d("#subscriber-chart"),l,u,f={responsive:false,legend:false,animationEasing:"easeOutExpo",maintainAspectRatio:false,tooltips:{backgroundColor:"rgba(56,56,56,0.9)",displayColors:false,cornerRadius:2,caretSize:8,callbacks:{label:function(a,e){return o.util.sprintf(o.l10n.dashboard.subscribers,k(a.yLabel))}}},scales:{xAxes:[{ticks:{maxTicksLimit:20},_type:"time",_time:{format:"MM/DD/YYYY HH:mm",round:"day",tooltipFormat:"ll HH:mm"}}],yAxes:[{ticks:{callback:function(a){return v(a,true)}}}]}};if(r.length){u=r[0].getContext("2d")}s.on("change",function(){b()}).trigger("change");!t&&a.postboxes.add_postbox_toggles("newsletter_page_mailster_dashboard");d(c).on("verified.mailster",function(a,e,t,i){d(".mailster-purchasecode").html(e);d(".mailster-username").html(t);d(".mailster-email").html(i);d("#mailster-mb-mailster").addClass("verified");d("#mailster-register-panel").delay(2500).fadeTo(400,0,function(){d("#mailster-register-panel").slideUp(400)})}).on("click",".locked",function(){d(".purchasecode").focus().select()}).on("click",".enable-auto-update",function(){var a=d(this);a.html(o.l10n.dashboard.checking);d.get(this.href,function(){a.remove()});return false}).on("click",".check-for-update",function(){var e=d(this);e.html(o.l10n.dashboard.checking);o.util.ajax("check_for_update",function(a){e.html(o.l10n.dashboard.check_again);if(a.success){e.closest(".postbox")[a.data.update?"addClass":"removeClass"]("has-update");d(".update-version").html(a.data.version);d(".update-last-check").html(a.data.last_update)}});return false}).one("click",".load-language",function(){var e=d(this);e.html(o.l10n.dashboard.downloading);o.util.ajax("load_language",function(a){if(a.success){e.html(o.l10n.dashboard.reload_page)}});return false}).on("click",".reset-license",function(){if(!confirm(o.l10n.dashboard.reset_license)){return false}});var h=function(t){if(!t){return}var i,n=d(".mailster-mb-"+t),a=n.find(".mailster-mb-select"),e=n.find(".mailster-mb-label"),s=n.find(".mailster-mb-link"),r=s.attr("href");if(!a.length){return}a.on("change",function(){l(d(this).val())}).trigger("change");d(c).on("heartbeat-tick",function(a,e){if(i){l(i,true)}});n.find(".piechart").easyPieChart({animate:1e3,rotate:180,barColor:o.colors.main,trackColor:o.colors.track,lineWidth:9,size:75,lineCap:"butt",onStep:function(a){this.$el.find("span").text(Math.round(a))},onStop:function(a){this.$el.find("span").text(Math.round(a))}});function l(a,e){if(!e){n.addClass("mailster-loading")}o.util.ajax("get_dashboard_data",{type:t,id:a},function(a){var e=a.data.data;s.html(e.name).removeAttr("class").addClass("mailster-mb-link").attr("href",r.replace("%d",e.ID));if(e.status){s.addClass("status-"+e.status)}n.find(".stats-total").html(e.sent_formatted);n.find(".stats-open").data("easyPieChart").update(e.openrate*100);n.find(".stats-clicks").data("easyPieChart").update(e.clickrate*100);n.find(".stats-unsubscribes").data("easyPieChart").update(e.unsubscriberate*100);n.find(".stats-bounces").data("easyPieChart").update(e.bouncerate*100);i=e.ID;n.removeClass("mailster-loading")})}};var m=new h("campaigns");var p=new h("lists");function b(a,e,t,i){n.addClass("mailster-loading");o.util.ajax("get_dashboard_chart",{range:s.val()},function(a){g();n.removeClass("mailster-loading");if(!l){l=new Chart(u,{type:"line",data:a.data.chart,options:f})}})}function g(){l=null;if(r){r.remove()}r=d("<canvas>").prependTo(i);u=r[0].getContext("2d");r.attr({width:i.width(),height:i.height()})}function v(a,e){if(a>=1e6){return(a/1e3).toFixed(1)+"M"}else if(a>=1e3&&!e){return(a/1e3).toFixed(1)+"K"}return!(a%1)?k(a):""}function k(a,e,t,i){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var n=!isFinite(+a)?0:+a;var s=!isFinite(+e)?0:Math.abs(e);var r=typeof i==="undefined"?",":i;var l=typeof t==="undefined"?".":t;var o="";var d=function(a,e){var t=Math.pow(10,e);return""+(Math.round(a*t)/t).toFixed(e)};o=(s?d(n,s):""+Math.round(n)).split(".");if(o[0].length>3){o[0]=o[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)}if((o[1]||"").length<s){o[1]=o[1]||"";o[1]+=new Array(s-o[1].length+1).join("0")}return o.join(l)}return o}(mailster||{},jQuery,window,document);