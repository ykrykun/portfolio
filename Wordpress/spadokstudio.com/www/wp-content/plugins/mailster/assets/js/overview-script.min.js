mailster=function(s,i,t,a){"use strict";var m=[],e=false,r=i("tr.type-newsletter"),n=i("#bulk-action-selector-top"),o=i("#bulk-action-selector-bottom");s.$.document.on("submit","#posts-filter",function(){var t=n.val(),a=o.val(),e=t!=-1?t:a!=-1?a:false;switch(e){case"finish":return confirm(s.l10n.campaigns.finish_campaigns);break;case"start":return confirm(s.l10n.campaigns.start_campaigns);break}}).on("click","a.live-action",function(){if(i(this).hasClass("finish")&&!confirm(s.l10n.campaigns.finish_campaign)){return false}var t=i(this).parent().parent().parent().addClass("loading");i.get(i(this).attr("href"),function(){setTimeout(function(){wp.heartbeat.connectNow()},500)});return false}).on("scroll",function(){clearTimeout(e);e=setTimeout(function(){wp.heartbeat.connectNow()},400)}).on("change",".hide-column-tog",function(){wp.heartbeat.connectNow()}).on("click",".toggle-row",function(){var t=i(this).parent().parent().attr("id").substring(5);if(m[t]){m[t]=[]}wp.heartbeat.connectNow()}).on("heartbeat-send",function(t,a){var e=[],n;r.each(function(){n=parseInt(i(this).find("input").eq(0).val(),10);m[n]=m[n]||{};if(s.util.inViewport(this))e.push(n)});a["mailster"]={page:"overview",ids:e,columns:i(".hide-column-tog:checked").map(function(){return this.value}).toArray()}}).on("heartbeat-tick",function(t,a){var l=false;if(a["mailster"]){if(!m){m=i.extend(a["mailster"],m);l=true}var u=false,f=0;i.each(r,function(r,o){var c;o=i(o);r=o.attr("id").replace("post-","");o.removeClass("loading");if(!a["mailster"][r])return;c=a["mailster"][r];o.find(".column-status")[c.cron?"removeClass":"addClass"]("cron-issue");o.find(".campaign-status").html(c.cron?"":c.status_title);i.each(c,function(t,a){if(!l&&m[r][t]==a)return;var e=m[r]&&m[r].status&&(c.status!=m[r].status||c.is_active!=m[r].is_active);switch(t){case"status":if(e){o.removeClass("status-"+m[r].status).addClass("status-"+c.status)}case"sent":case"total":case"sent_formatted":break;case"column-status":if(c.status=="active"&&!e){var n=o.find(".campaign-progress"),s=Math.round(c.sent/c.total*100);n.find(".bar").width(s+"%");n.find("span").eq(1).html(c.sent_formatted);n.find("span").eq(2).html(c.sent_formatted);n.find("var").html(s+"%")}if(!e)break;default:var i=o.find("."+t);if(!i.is(":visible"))break;i.fadeTo(10,.01,function(){i.html(a).delay(10*f++).fadeTo(200,1)})}u=true})});if(u)wp.heartbeat.interval("fast");m=i.extend(m,a["mailster"])}});wp.heartbeat.interval("fast");if(wp.heartbeat.connectNow)wp.heartbeat.connectNow();return s}(mailster||{},jQuery,window,document);