mailster=function(t,e,i,a){"use strict";var n=e(".mailster-setup-step"),s,l,d=e(".status"),r=e(".spinner"),c=location.hash.substr(1);if(c&&e("#step_"+c).length){s=e("#step_"+c)}else{s=n.eq(0)}l=s.attr("id").replace(/^step_/,"");n.hide();h(l);e("form.mailster-setup-step-form").on("submit",function(){e(".next-step:visible").hide();return false});e("#mailster-setup").on("click",".validation-skip-step",function(){return confirm(t.l10n.setup.skip_validation)}).on("click",".next-step",function(){if(e(this).hasClass("disabled"))return false;if(tinymce)tinymce.get("post_content").save();var i=e(this).parent().parent().find("form"),a=i.serialize();t.util.ajax("wizard_save",{id:l,data:a},function(t){})}).on("click",".load-language",function(){d.html(t.l10n.setup.load_language);r.css("visibility","visible");t.util.ajax("load_language",function(t){r.css("visibility","hidden");d.html(t.data.html);if(t.success){location.reload()}});return false}).on("click",".quick-install",function(){var t=e(this);v(t.data("method"),t.data("plugin"),"install",null,function(){d.html("");r.css("visibility","hidden");o.find("a.nav-tab-active").trigger("click")})}).on("click",".edit-slug",function(){e(this).parent().parent().find("span").hide().filter(".edit-slug-area").show().find("input").focus().select()});t.$.document.on("verified.mailster",function(){e(".validation-next-step").removeClass("disabled");e(".validation-skip-step").addClass("disabled")});f();var o=e("#deliverynav"),u=e(".deliverytab");o.on("click","a.nav-tab",function(){o.find("a").removeClass("nav-tab-active");u.hide();var i=e(this).addClass("nav-tab-active").attr("href").substr(1);e("#deliverymethod").val(i);e("#deliverytab-"+i).show();if(e("#deliverytab-"+i).find(".quick-install").length){e(".delivery-next-step").addClass("disabled").html(sprintf(t.l10n.setup.enable_first,e(this).html()))}else{e(".delivery-next-step").removeClass("disabled").html(sprintf(t.l10n.setup.use_deliverymethod,e(this).html()))}return false});t.$.window.on("hashchange",function(){var i=location.hash.substr(1)||"start",a=e(".mailster-setup-steps-nav").find("a[href='#"+i+"']"),n,s;if(a.length){h(i);a.parent().parent().find("a").removeClass("next prev current");a.parent().prevAll().find("a").addClass("prev");a.addClass("current");if(tinymce&&tinymce.activeEditor)tinymce.activeEditor.theme.resizeTo("100%",200)}if("finish"==i){t.util.ajax("wizard_save",{id:i,data:null})}});t.events.push("documentReady",function(){t.$.window.trigger("hashchange")});function f(){d.html(t.l10n.setup.check_language);r.css("visibility","visible");t.util.ajax("check_language",function(t){r.css("visibility","hidden");d.html(t.data.html);if(t.success){}})}function h(t){var i=e("#step_"+t);if(i.length){s.hide();s=i;s.show();l=t}}function v(i,a,n,s,l){d.html(t.l10n.setup.install_addon);r.css("visibility","visible");var c=e("#deliverytab-"+i);t.util.ajax("quick_install",{plugin:a,step:n,context:s},function(t){if(t.success){if(t.data.next){v(i,a,t.data.next,["deliverymethod_tab_"+i],l)}else if(t.data.content){c.html(t.data.content);l&&l(t)}}else{}},function(t,e,i){})}return t}(mailster||{},jQuery,window,document);